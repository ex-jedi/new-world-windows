(()=>{"use strict";var e=[(e,t,o)=>{o.r(t),(0,o(1).reframe)(".blog-video-embed iframe")},(e,t,o)=>{function n(){const e=document.querySelector(".cookie-warning-wrapper"),t=document.querySelector(".cookie-warning-button");"shown"!==localStorage.getItem("cookieSeen")?e.classList.add("show-cookie-warning"):e.style.display="none",t.addEventListener("click",(()=>{localStorage.setItem("cookieSeen","shown"),e.classList.remove("show-cookie-warning"),e.addEventListener("transitionend",(()=>{e.style.display="none"}))}),{once:!0})}function s(e){9===e.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",s),window.addEventListener("mousedown",i))}function i(){document.body.classList.remove("user-is-tabbing"),window.removeEventListener("mousedown",i),window.addEventListener("keydown",s)}function r(e,t){let o="string"==typeof e?document.querySelectorAll(e):e;const n=t||"js-reframe";"length"in o||(o=[o]);for(let e=0;e<o.length;e+=1){const t=o[e];if(-1!==t.className.split(" ").indexOf(n)||t.style.width.indexOf("%")>-1)continue;const s=(t.getAttribute("height")||t.offsetHeight)/(t.getAttribute("width")||t.offsetWidth)*100,i=document.createElement("div");i.className=n;const r=i.style;r.position="relative",r.width="100%",r.paddingTop=`${s}%`;const a=t.style;a.position="absolute",a.width="100%",a.height="100%",a.left="0",a.top="0",t.parentNode.insertBefore(i,t),t.parentNode.removeChild(t),i.appendChild(t)}}function a(e,t){if(!e)throw new Error(t)}function u(e){a(!e||"object"==typeof e,`options must be an object, got ${e} (${typeof e})`);const t={accessToken:null,accessTokenTimeout:1e4,after:null,apiTimeout:1e4,apiLimit:null,before:null,debug:!1,error:null,filter:null,limit:null,mock:!1,render:null,sort:null,success:null,target:"instafeed",template:'<a href="{{link}}"><img title="{{caption}}" src="{{image}}" /></a>',templateBoundaries:["{{","}}"],transform:null};if(e)for(const o in t)void 0!==e[o]&&(t[o]=e[o]);a("string"==typeof t.target||"object"==typeof t.target,`target must be a string or DOM node, got ${t.target} (${typeof t.target})`),a("string"==typeof t.accessToken||"function"==typeof t.accessToken,`accessToken must be a string or function, got ${t.accessToken} (${typeof t.accessToken})`),a("number"==typeof t.accessTokenTimeout,`accessTokenTimeout must be a number, got ${t.accessTokenTimeout} (${typeof t.accessTokenTimeout})`),a("number"==typeof t.apiTimeout,`apiTimeout must be a number, got ${t.apiTimeout} (${typeof t.apiTimeout})`),a("boolean"==typeof t.debug,`debug must be true or false, got ${t.debug} (${typeof t.debug})`),a("boolean"==typeof t.mock,`mock must be true or false, got ${t.mock} (${typeof t.mock})`),a("object"==typeof t.templateBoundaries&&2===t.templateBoundaries.length&&"string"==typeof t.templateBoundaries[0]&&"string"==typeof t.templateBoundaries[1],`templateBoundaries must be an array of 2 strings, got ${t.templateBoundaries} (${typeof t.templateBoundaries})`),a(!t.template||"string"==typeof t.template,`template must null or string, got ${t.template} (${typeof t.template})`),a(!t.error||"function"==typeof t.error,`error must be null or function, got ${t.error} (${typeof t.error})`),a(!t.before||"function"==typeof t.before,`before must be null or function, got ${t.before} (${typeof t.before})`),a(!t.after||"function"==typeof t.after,`after must be null or function, got ${t.after} (${typeof t.after})`),a(!t.success||"function"==typeof t.success,`success must be null or function, got ${t.success} (${typeof t.success})`),a(!t.filter||"function"==typeof t.filter,`filter must be null or function, got ${t.filter} (${typeof t.filter})`),a(!t.transform||"function"==typeof t.transform,`transform must be null or function, got ${t.transform} (${typeof t.transform})`),a(!t.sort||"function"==typeof t.sort,`sort must be null or function, got ${t.sort} (${typeof t.sort})`),a(!t.render||"function"==typeof t.render,`render must be null or function, got ${t.render} (${typeof t.render})`),a(!t.limit||"number"==typeof t.limit,`limit must be null or number, got ${t.limit} (${typeof t.limit})`),a(!t.apiLimit||"number"==typeof t.apiLimit,`apiLimit must null or number, got ${t.apiLimit} (${typeof t.apiLimit})`),this._state={running:!1,node:null,token:null,paging:null,pool:[]},this._options=t}async function l(){const e=await fetch("https://ig.instant-tokens.com/users/86e98f2a-84d4-4e76-80d7-af04a32bbc58/instagram/17841408526477388/token?userSecret=l7y9v65l95vmkful05c7b");new u({accessToken:(await e.json()).Token,limit:12,template:'\n    <div class="instagram-image-wrapper">\n      <a href="{{link}}">\n        <img class="instagram-image" title="{{caption}}" src="{{image}}">\n      </a>\n    </div> '}).run()}o.r(t),o.d(t,{cookieWarning:()=>n,handleFirstTab:()=>s,reframe:()=>r,displayInstagramFeed:()=>l}),u.prototype.run=function(){const e=this;return this._debug("run","options",this._options),this._debug("run","state",this._state),this._state.running?(this._debug("run","already running, skipping"),!1):(this._start(),this._debug("run","getting dom node"),"string"==typeof this._options.target?this._state.node=document.getElementById(this._options.target):this._state.node=this._options.target,this._state.node?(this._debug("run","got dom node",this._state.node),this._debug("run","getting access token"),this._getAccessToken((function(t,o){if(t)return e._debug("onTokenReceived","error",t),void e._fail(new Error(`error getting access token: ${t.message}`));e._debug("onTokenReceived","got token",o),e._state.token=o,e._showNext((function(t){if(t)return e._debug("onNextShown","error",t),void e._fail(t);e._finish()}))})),!0):(this._fail(new Error(`no element found with ID ${this._options.target}`)),!1))},u.prototype.hasNext=function(){const{paging:e}=this._state,{pool:t}=this._state;return this._debug("hasNext","paging",e),this._debug("hasNext","pool",t.length,t),t.length>0||e&&"string"==typeof e.next},u.prototype.next=function(){const e=this;return e.hasNext()?e._state.running?(e._debug("next","already running, skipping"),!1):(e._start(),void e._showNext((function(t){if(t)return e._debug("onNextShown","error",t),void e._fail(t);e._finish()}))):(e._debug("next","hasNext is false, skipping"),!1)},u.prototype._showNext=function(e){const t=this;let o=null,n=null;const s="number"==typeof this._options.limit;if(t._debug("showNext","pool",t._state.pool.length,t._state.pool),t._state.pool.length>0){if(n=s?t._state.pool.splice(0,t._options.limit):t._state.pool.splice(0),t._debug("showNext","items from pool",n.length,n),t._debug("showNext","updated pool",t._state.pool.length,t._state.pool),t._options.mock)t._debug("showNext","mock enabled, skipping render");else try{t._renderData(n)}catch(t){return void e(t)}e(null)}else t._state.paging&&"string"==typeof t._state.paging.next?o=t._state.paging.next:(o=`https://graph.instagram.com/me/media?fields=caption,id,media_type,media_url,permalink,thumbnail_url,timestamp,username&access_token=${t._state.token}`,t._options.apiLimit||"number"!=typeof t._options.limit?"number"==typeof t._options.apiLimit&&(t._debug("showNext","apiLimit set, overriding limit",t._options.apiLimit,t._options.limit),o=`${o}&limit=${t._options.apiLimit}`):(t._debug("showNext","no apiLimit set, falling back to limit",t._options.apiLimit,t._options.limit),o=`${o}&limit=${t._options.limit}`)),t._debug("showNext","making request",o),t._makeApiRequest(o,(function(o,n){let s=null;if(o)return t._debug("onResponseReceived","error",o),void e(new Error(`api request error: ${o.message}`));t._debug("onResponseReceived","data",n),t._success(n),t._debug("onResponseReceived","setting paging",n.paging),t._state.paging=n.paging;try{if(s=t._processData(n),t._debug("onResponseReceived","processed data",s),s.unused&&s.unused.length>0){t._debug("onResponseReceived","saving unused to pool",s.unused.length,s.unused);for(let e=0;e<s.unused.length;e++)t._state.pool.push(s.unused[e])}}catch(t){return void e(t)}if(t._options.mock)t._debug("onResponseReceived","mock enabled, skipping append");else try{t._renderData(s.items)}catch(t){return void e(t)}e(null)}))},u.prototype._processData=function(e){const t="function"==typeof this._options.transform,o="function"==typeof this._options.filter,n="function"==typeof this._options.sort,s="number"==typeof this._options.limit,i=[];let r=null,a=null,u=null,l=null,c=null;if(this._debug("processData","hasFilter",o,"hasTransform",t,"hasSort",n,"hasLimit",s),"object"!=typeof e||"object"!=typeof e.data||e.data.length<=0)return null;for(let n=0;n<e.data.length;n++){if(a=this._getItemData(e.data[n]),t)try{u=this._options.transform(a),this._debug("processData","transformed item",a,u)}catch(e){throw this._debug("processData","error calling transform",e),new Error(`error in transform: ${e.message}`)}else u=a;if(o){try{l=this._options.filter(u),this._debug("processData","filter item result",u,l)}catch(e){throw this._debug("processData","error calling filter",e),new Error(`error in filter: ${e.message}`)}l&&i.push(u)}else i.push(u)}if(n)try{i.sort(this._options.sort)}catch(e){throw this._debug("processData","error calling sort",e),new Error(`error in sort: ${e.message}`)}return s&&(r=i.length-this._options.limit,this._debug("processData","checking limit",i.length,this._options.limit,r),r>0&&(c=i.slice(i.length-r),this._debug("processData","unusedItems",c.length,c),i.splice(i.length-r,r))),{items:i,unused:c}},u.prototype._extractTags=function(e){const t=/#([^\s]+)/gi,o=/[~`!@#$%^&*\(\)\-\+={}\[\]:;"'<>\?,\./|\\\s]+/i,n=[];let s=null;if("string"==typeof e)for(;null!==(s=t.exec(e));)!1===o.test(s[1])&&n.push(s[1]);return n},u.prototype._getItemData=function(e){let t=null,o=null;switch(e.media_type){case"IMAGE":t="image",o=e.media_url;break;case"VIDEO":t="video",o=e.thumbnail_url;break;case"CAROUSEL_ALBUM":t="album",o=e.media_url}return{caption:e.caption,tags:this._extractTags(e.caption),id:e.id,image:o,link:e.permalink,model:e,timestamp:e.timestamp,type:t,username:e.username}},u.prototype._renderData=function(e){const t="string"==typeof this._options.template,o="function"==typeof this._options.render;let n=null,s=null,i=null,r="";if(this._debug("renderData","hasTemplate",t,"hasRender",o),!("object"!=typeof e||e.length<=0)){for(let i=0;i<e.length;i++){if(n=e[i],o)try{s=this._options.render(n,this._options),this._debug("renderData","custom render result",n,s)}catch(e){throw this._debug("renderData","error calling render",e),new Error(`error in render: ${e.message}`)}else t&&(s=this._basicRender(n));s?r+=s:this._debug("renderData","render item did not return any content",n)}for(this._debug("renderData","html content",r),i=document.createElement("div"),i.innerHTML=r,this._debug("renderData","container",i,i.childNodes.length,i.childNodes);i.childNodes.length>0;)this._debug("renderData","appending child",i.childNodes[0]),this._state.node.appendChild(i.childNodes[0])}},u.prototype._basicRender=function(e){const t=new RegExp(`${this._options.templateBoundaries[0]}([\\s\\w.]+)${this._options.templateBoundaries[1]}`,"gm"),{template:o}=this._options;let n=null,s="",i=null,r=0,a=null,u=null;for(;null!==(n=t.exec(o));)a=n[1],i=o.slice(r,n.index),s+=i,u=this._valueForKeyPath(a,e),u&&(s+=u.toString()),r=t.lastIndex;return r<o.length&&(i=o.slice(r,o.length),s+=i),s},u.prototype._valueForKeyPath=function(e,t){const o=/([\w]+)/gm;let n=null,s=null,i=t;for(;null!==(n=o.exec(e));){if("object"!=typeof i)return null;s=n[1],i=i[s]}return i},u.prototype._fail=function(e){!this._runHook("error",e)&&console&&"function"==typeof console.error&&console.error(e),this._state.running=!1},u.prototype._start=function(){this._state.running=!0,this._runHook("before")},u.prototype._finish=function(){this._runHook("after"),this._state.running=!1},u.prototype._success=function(e){this._runHook("success",e),this._state.running=!1},u.prototype._makeApiRequest=function(e,t){let o=!1;const n=this;let s=null;const i=function(e,n){o||(o=!0,t(e,n))};s=new XMLHttpRequest,s.ontimeout=function(){i(new Error("api request timed out"))},s.onerror=function(){i(new Error("api connection error"))},s.onload=function(e){const t=s.getResponseHeader("Content-Type");let o=null;if(n._debug("apiRequestOnLoad","loaded",e),n._debug("apiRequestOnLoad","response status",s.status),n._debug("apiRequestOnLoad","response content type",t),t.indexOf("application/json")>=0)try{o=JSON.parse(s.responseText)}catch(e){return n._debug("apiRequestOnLoad","json parsing error",e,s.responseText),void i(new Error("error parsing response json"))}200===s.status?i(null,o):o&&o.error?i(new Error(`${o.error.code} ${o.error.message}`)):i(new Error(`status code ${s.status}`))},s.open("GET",e,!0),s.timeout=this._options.apiTimeout,s.send()},u.prototype._getAccessToken=function(e){let t=!1;const o=this;let n=null;const s=function(o,s){t||(t=!0,clearTimeout(n),e(o,s))};if("function"==typeof this._options.accessToken){this._debug("getAccessToken","calling accessToken as function"),n=setTimeout((function(){o._debug("getAccessToken","timeout check",t),s(new Error("accessToken timed out"),null)}),this._options.accessTokenTimeout);try{this._options.accessToken((function(e,n){o._debug("getAccessToken","received accessToken callback",t,e,n),s(e,n)}))}catch(e){this._debug("getAccessToken","error invoking the accessToken as function",e),s(e,null)}}else this._debug("getAccessToken","treating accessToken as static",typeof this._options.accessToken),s(null,this._options.accessToken)},u.prototype._debug=function(){let e=null;this._options.debug&&console&&"function"==typeof console.log&&(e=[].slice.call(arguments),e[0]=`[Instafeed] [${e[0]}]`,console.log.apply(null,e))},u.prototype._runHook=function(e,t){let o=!1;if("function"==typeof this._options[e])try{this._options[e](t),o=!0}catch(t){this._debug("runHook","error calling hook",e,t)}return o}}],t={};function o(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o(0)})();
//# sourceMappingURL=blog-post-min.js.map